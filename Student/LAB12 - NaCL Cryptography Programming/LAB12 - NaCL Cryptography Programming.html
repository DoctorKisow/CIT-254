<!-- LAB HEADER / TOC -->
<p id="#lab12"></p>
<table border="0" style="border-collapse: collapse; width: 99%; border-style: none; height: 300px;">
  <tbody>
    <tr style="height: 102px;">
      <td colspan="2" style="width: 100%; text-align: center; vertical-align: top;"><img src="https://web.acd.ccac.edu/~mkisow/assets/ccac-logo.png" style="border: 0px solid #000000;" width="311" height="100" alt="ccac-logo"/></td>
    </tr>
    <tr style="height: 30px;">
      <td colspan="2" style="font-family: arial, helvetica, sans-serif; font-size: 24pt; width: 100%; text-align: center; vertical-align: top;"><strong>LAB 12: NaCL Cryptography Programming</strong></span></td>
    </tr>

    <tr style="height: 22.5px;">
      <td style="width: 72%; height: 22.50px;"><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt; color: #ba372a;"><strong>INSTRUCTIONS</strong></span></td>
    </tr>
    <tr>
      <td style="width: 72%; vertical-align: top; height: 75px; text-align: justify;"><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Students will use their virtual machine (VM) environment and Python3, along with the NaCl library, to complete Parts 1-4 of these cryptography labs. Each part focuses on a different cryptographic concept: one-time pad encryption, symmetric key cryptography, public key exchange, and secure password storage. By following the provided instructions and leveraging the virtual environment, students will build and test Python scripts that demonstrate encryption and decryption techniques, implement secure communication protocols, and protect sensitive information. This hands-on approach ensures practical understanding and application of cryptography within a controlled and secure environment.<br /></span><br /><p style="font-family: arial, helvetica, sans-serif; color: #ba372a; font-size: 12pt; text-align: center; margin: 0; padding: 0;"><strong><em>Upload your answers to this lab.</em></strong></p></td>
    </tr>
    <tr>
      <td style="width: 72%; height: 22.50px; vertical-align: top;"><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt; color: #ba372a;"><strong>OBJECTIVE</strong></span></td>
    </tr>
    <tr>
      <td style="width: 72%; vertical-align: top; height: 75px; text-align: justify;"><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><p>The objective of these labs is to empower students with practical skills in Python programming and cryptography by completing tasks that align with critical cybersecurity competencies. These include developing scripts for encryption and decryption, implementing secure communication protocols using elliptic curve cryptography, and safeguarding sensitive information through password hashing and secure storage mechanisms. By addressing these challenges, students will gain the ability to identify vulnerabilities, apply cryptographic tools, and implement solutions that enhance the security and integrity of digital systems.</p></span></td>
    </tr>
    <tr>
      <td style="width: 72%; vertical-align: top; height: 75px; text-align: justify;">
        <p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Begin by logging into the Academic vSphere Portal using your student credentials. Once logged in, navigate to your assigned Virtual Application (VApp) within the portal. This lab will use the following VM's within your VApp with the following credentials.</span></p>
        <blockquote>
          <p style="margin: 0; padding: 0;"><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">&emsp;<strong>Kali Linux</strong></span></p>
          <p style="margin: 0; padding: 0;"><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">&emsp;<strong>Username</strong>: labuser</span></p>
          <p style="margin: 0; padding: 0;"><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">&emsp;<strong>Password</strong>: P@$$w0rd</span></p>
        </blockquote>
      </td>
    </tr>
  </tbody>
</table>

<!-- VERSION/REVISION -->
<p style="font-family: arial, helvetica, sans-serif; font-size: 12pt; text-align: center; margin: 0; padding: 0; color: #ced4d9">VERSION 2</p>
<p style="font-family: arial, helvetica, sans-serif; font-size: 12pt; text-align: center; margin: 0; padding: 0; color: #ced4d9">REVISED 27-DEC-2024</p>


<!-- PART 1 -->
<hr />
<span style="font-family: arial, helvetica, sans-serif; font-size: 14pt; color: #ba372a;"><strong>Part 1 - One-Time Pad Cryptography</strong></span></p>

<ol style="font-family: arial, helvetica, sans-serif; font-size: 12pt;" start="1">
  <li><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Dr. Kisow wishes to send a message to the class using a one-time pad because it has the property of <a href="https://en.wikipedia.org/wiki/One-time_pad#Perfect_secrecy" target="_blank" rel="noopener"><span style="color: #ba372a;">perfect secrecy</span></a>.</span>
    <ol style="list-style-type: lower-alpha;" start="a">

      <!-- A -->
      <li><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Two files are provided in the Part1 folder:</span>
        <ol style="list-style-type: lower-roman;" start="i">
          <li><p style="margin: 0; padding: 0;"><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">The encrypted message (originally ASCII text) - part1.ciphertext.bin</span></p></li>
          <li><p style="margin: 0; padding: 0;"><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">The one-time pad, cryptographically random - part1.otp.bin</span></p></li>
        </ol>
      </li>
    </ol>
  </li>
</ol>

<ol style="font-family: arial, helvetica, sans-serif; font-size: 12pt;" start="2">
  <li><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Let's begin this part of our lab by starting in the /labs/LAB12/Part1 folder and starting the virtual environment.</span></li>
    <!-- CODE -->
    <table border="0" style="border-collapse: collapse; width: 85%; background-color: #000000; font-family: 'courier new', courier, monospace; border-style: none; border-radius: 5px; box-shadow: 5px 5px 1px 0px rgba(50, 50, 50, 0.75); overflow: hidden;">
      <tbody>
        <tr style="background-color: #ced4e9;">
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #f44336; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #ffee58; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #66bb6a; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 94%; text-align: center;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 14pt;"><strong>CODE</strong></span></td>
        </tr>
        <tr>
          <td colspan="4" style="width: 99%;">
            <p style="margin: 0; padding: 0;">
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #2dc26b;">&nbsp;&nbsp;# CHANGE DIRECTORY</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #ced4d9;">&nbsp;&nbsp;$ cd <span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">/labs/LAB12/Part1</span></span></strong><br /><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #2dc26b;">&nbsp;&nbsp;# ACTIVATE THE VIRTUAL ENVIRONMENT</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #ced4d9;">&nbsp;&nbsp;$ source <span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">venv/bin/activate</span></span></strong>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <p></p>
  </li>
  <li><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Use the nano text editor to start writing your part1.py decryption script.</span></p>
    <!-- CODE -->
    <table border="0" style="border-collapse: collapse; width: 85%; background-color: #000000; font-family: 'courier new', courier, monospace; border-style: none; border-radius: 5px; box-shadow: 5px 5px 1px 0px rgba(50, 50, 50, 0.75); overflow: hidden;">
      <tbody>
        <tr style="background-color: #ced4e9;">
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #f44336; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #ffee58; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #66bb6a; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 94%; text-align: center;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 14pt;"><strong>CODE</strong></span></td>
        </tr>
        <tr>
          <td colspan="4" style="width: 99%;">
            <p style="margin: 0; padding: 0;">
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #2dc26b;">&nbsp;&nbsp;# TEXT EDITOR</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #ced4d9;">&nbsp;&nbsp;$ nano <span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">part1.py</span></span></strong>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <p></p>
  </li>
  <li><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Test your script by invoking python3 part1.py part1.ciphertext.bin part1.otp.bin</span></p>
    <!-- CODE -->
    <table border="0" style="border-collapse: collapse; width: 85%; background-color: #000000; font-family: 'courier new', courier, monospace; border-style: none; border-radius: 5px; box-shadow: 5px 5px 1px 0px rgba(50, 50, 50, 0.75); overflow: hidden;">
      <tbody>
        <tr style="background-color: #ced4e9;">
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #f44336; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #ffee58; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #66bb6a; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 94%; text-align: center;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 14pt;"><strong>CODE</strong></span></td>
        </tr>
        <tr>
          <td colspan="4" style="width: 99%;">
            <p style="margin: 0; padding: 0;">
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #2dc26b;">&nbsp;&nbsp;# TESTING</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #ced4d9;">&nbsp;&nbsp;$ python3 <span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">part1.py part1.ciphertext.bin part1.otp.bin</span></span></strong>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <p></p>
  </li>
  <li><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">When completed testing and you are ready to submit part1.py make sure you deactivate the virtual environment; then change back to the LAB12 directory.</span></p>
    <!-- CODE -->
    <table border="0" style="border-collapse: collapse; width: 85%; background-color: #000000; font-family: 'courier new', courier, monospace; border-style: none; border-radius: 5px; box-shadow: 5px 5px 1px 0px rgba(50, 50, 50, 0.75); overflow: hidden;">
      <tbody>
        <tr style="background-color: #ced4e9;">
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #f44336; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #ffee58; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #66bb6a; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 94%; text-align: center;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 14pt;"><strong>CODE</strong></span></td>
        </tr>
        <tr>
          <td colspan="4" style="width: 99%;">
            <p style="margin: 0; padding: 0;">
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #2dc26b;">&nbsp;&nbsp;# DEACTIVATE THE VIRTUAL ENVIRONMENT</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #ced4d9;">&nbsp;&nbsp;$ deactivate <span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;"></span></span></strong><br /><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #2dc26b;">&nbsp;&nbsp;# CHANGE BACK TO THE LAB12 DIRECTORY</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #ced4d9;">&nbsp;&nbsp;$ cd .. <span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;"></span></span></strong>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <p></p>
  </li>
</ol>

<!-- 1.5 DELIVERABLE -->
<blockquote>
  <table border="0" style="border-collapse: collapse; width: 85%; background-color: #ced4d9; border-style: none; border-radius: 5px; box-shadow: 5px 5px 1px 0px rgba(50, 50, 50, 0.75); overflow: hidden;">
    <tbody>
      <tr>
        <td style="width: 2%; background-color: #000000;">&nbsp;</td>
        <td colspan="5" style="width: 98%; text-align: left; vertical-align: top;">
          <p style="margin: 0; padding: 0;">
            <img src="https://web.acd.ccac.edu/~mkisow/assets/black-deliverable-24x24.svg"  style="border: 0px solid #000000;" height="24" width="24" alt="deliverable"/>
            <strong><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 14pt;">DELIVERABLE</span></strong>
          </p>
        </td>
      </tr>
      <tr>
        <td style="width: 2%; background-color: #000000;">&nbsp;</td>
        <td style="width: 5%; text-align: right; vertical-align: top;"><strong><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">1.5</span></strong></td>
        <td style="width: 93%;">
          <p style="margin: 0; padding: 0;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">Write a Python3 program named <span style="font-family: 'courier new', courier, monospace; background-color: #ecdbdb; color: #ba372a;"><strong>part1.py</strong></span> that reverses the one-time pad and prints the plaintext message to the screen.</span></p>
        </td>
      </tr>
    </tbody>
  </table>
</blockquote>


<!-- PART 2 -->
<hr />
<span style="font-family: arial, helvetica, sans-serif; font-size: 14pt; color: #ba372a;"><strong>Part 2 - Symmetric Key Cryptography</strong></span></p>

<ol style="font-family: arial, helvetica, sans-serif; font-size: 12pt;" start="1">
  <li><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Dr. Kisow finds a one-time pad is too cumbersome of a secret to manage and distribute. Instead, he wishes to send a message to the class using symmetric key encryption. He uses the Salsa20 stream cipher with Poly1305 message authentication code provided by the Libsodium library.</span>
    <ol style="list-style-type: lower-alpha;" start="a">

      <!-- A -->
      <li><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Two files are provided in the Part2 folder:</span>
        <ol style="list-style-type: lower-roman;" start="i">
          <li><p style="margin: 0; padding: 0;"><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">The encrypted message (originally ASCII text) - part2.ciphertext.bin</span></p></li>
          <li><p style="margin: 0; padding: 0;"><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">The symmetric key, cryptographically random - part2.key.bin</span></p></li>
        </ol>
      </li>
    </ol>
  </li>
</ol>

<ol style="font-family: arial, helvetica, sans-serif; font-size: 12pt;" start="2">
  <li><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Let's begin this part of our lab by starting in the /labs/LAB12/Part2 folder and starting the virtual environment.</span></li>
    <!-- CODE -->
    <table border="0" style="border-collapse: collapse; width: 85%; background-color: #000000; font-family: 'courier new', courier, monospace; border-style: none; border-radius: 5px; box-shadow: 5px 5px 1px 0px rgba(50, 50, 50, 0.75); overflow: hidden;">
      <tbody>
        <tr style="background-color: #ced4e9;">
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #f44336; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #ffee58; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #66bb6a; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 94%; text-align: center;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 14pt;"><strong>CODE</strong></span></td>
        </tr>
        <tr>
          <td colspan="4" style="width: 99%;">
            <p style="margin: 0; padding: 0;">
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #2dc26b;">&nbsp;&nbsp;# CHANGE DIRECTORY</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #ced4d9;">&nbsp;&nbsp;$ cd <span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">/labs/LAB12/Part2</span></span></strong><br /><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #2dc26b;">&nbsp;&nbsp;# ACTIVATE THE VIRTUAL ENVIRONMENT</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #ced4d9;">&nbsp;&nbsp;$ source <span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">venv/bin/activate</span></span></strong>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <p></p>
  </li>
  <li><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Use the nano text editor to start writing your part1.py decryption script.</span></p>
    <!-- CODE -->
    <table border="0" style="border-collapse: collapse; width: 85%; background-color: #000000; font-family: 'courier new', courier, monospace; border-style: none; border-radius: 5px; box-shadow: 5px 5px 1px 0px rgba(50, 50, 50, 0.75); overflow: hidden;">
      <tbody>
        <tr style="background-color: #ced4e9;">
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #f44336; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #ffee58; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #66bb6a; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 94%; text-align: center;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 14pt;"><strong>CODE</strong></span></td>
        </tr>
        <tr>
          <td colspan="4" style="width: 99%;">
            <p style="margin: 0; padding: 0;">
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #2dc26b;">&nbsp;&nbsp;# TEXT EDITOR</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #ced4d9;">&nbsp;&nbsp;$ nano <span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">part2.py</span></span></strong>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <p></p>
  </li>
  <li><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Test your script by invoking python3 part1.py.</span></p>
    <!-- CODE -->
    <table border="0" style="border-collapse: collapse; width: 85%; background-color: #000000; font-family: 'courier new', courier, monospace; border-style: none; border-radius: 5px; box-shadow: 5px 5px 1px 0px rgba(50, 50, 50, 0.75); overflow: hidden;">
      <tbody>
        <tr style="background-color: #ced4e9;">
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #f44336; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #ffee58; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #66bb6a; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 94%; text-align: center;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 14pt;"><strong>CODE</strong></span></td>
        </tr>
        <tr>
          <td colspan="4" style="width: 99%;">
            <p style="margin: 0; padding: 0;">
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #2dc26b;">&nbsp;&nbsp;# TESTING</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #ced4d9;">&nbsp;&nbsp;$ python3 <span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">part2.py part2.ciphertext.bin part2.key.bin</span></span></strong>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <p></p>
  </li>
  <li><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">When completed testing and you are ready to submit part2.py make sure you deactivate the virtual environment; then change back to the LAB12 directory.</span></p>
    <!-- CODE -->
    <table border="0" style="border-collapse: collapse; width: 85%; background-color: #000000; font-family: 'courier new', courier, monospace; border-style: none; border-radius: 5px; box-shadow: 5px 5px 1px 0px rgba(50, 50, 50, 0.75); overflow: hidden;">
      <tbody>
        <tr style="background-color: #ced4e9;">
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #f44336; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #ffee58; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #66bb6a; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 94%; text-align: center;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 14pt;"><strong>CODE</strong></span></td>
        </tr>
        <tr>
          <td colspan="4" style="width: 99%;">
            <p style="margin: 0; padding: 0;">
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #2dc26b;">&nbsp;&nbsp;# DEACTIVATE THE VIRTUAL ENVIRONMENT</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #ced4d9;">&nbsp;&nbsp;$ deactivate <span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;"></span></span></strong><br /><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #2dc26b;">&nbsp;&nbsp;# CHANGE BACK TO THE LAB12 DIRECTORY</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #ced4d9;">&nbsp;&nbsp;$ cd .. <span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;"></span></span></strong>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <p></p>
  </li>
</ol>

<!-- 2.5 DELIVERABLE -->
<blockquote>
  <table border="0" style="border-collapse: collapse; width: 85%; background-color: #ced4d9; border-style: none; border-radius: 5px; box-shadow: 5px 5px 1px 0px rgba(50, 50, 50, 0.75); overflow: hidden;">
    <tbody>
      <tr>
        <td style="width: 2%; background-color: #000000;">&nbsp;</td>
        <td colspan="5" style="width: 98%; text-align: left; vertical-align: top;">
          <p style="margin: 0; padding: 0;">
            <img src="https://web.acd.ccac.edu/~mkisow/assets/black-deliverable-24x24.svg"  style="border: 0px solid #000000;" height="24" width="24" alt="deliverable"/>
            <strong><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 14pt;">DELIVERABLE</span></strong>
          </p>
        </td>
      </tr>
      <tr>
        <td style="width: 2%; background-color: #000000;">&nbsp;</td>
        <td style="width: 5%; text-align: right; vertical-align: top;"><strong><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">2.5</span></strong></td>
        <td style="width: 93%;">
          <p style="margin: 0; padding: 0;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">Write a Python3 program named <span style="font-family: 'courier new', courier, monospace; background-color: #ecdbdb; color: #ba372a;"><strong>part2.py</strong></span> that decrypts and prints the plaintext message to the screen.</span></p>
        </td>
      </tr>
    </tbody>
  </table>
</blockquote>


<!-- PART 3 -->
<hr />
<span style="font-family: arial, helvetica, sans-serif; font-size: 14pt; color: #ba372a;"><strong>Part 3 - Public Key Cryptography</strong></span></p>

<ol style="font-family: arial, helvetica, sans-serif; font-size: 12pt;" start="1">
  <li><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><p>Dr. Kisow doesn't like having to distribute a secret symmetric key to the students to allow them to receive his messages. Instead, he wishes to send a message to the class using public key encryption and only distribute public keys, while keeping his secret key secret. He will use Curve25519 high-speed elliptic curve cryptography to accomplish this.</span></p>
    <ol style="list-style-type: lower-alpha;" start="a">

      <!-- A -->
      <li><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Your program must transmit to the <span style="font-family: 'courier new', courier, monospace; background-color: #ecdbdb; color: #ba372a;"><strong>http://otp.kisow.org:12001/</strong></span> server the following payload in a "HTTP-like" format as an ASCII string:</span>
        <!-- CODE -->
        <blockquote>
          <table border="0" style="border-collapse: collapse; width: 85%; background-color: #000000; font-family: 'courier new', courier, monospace; border-style: none; border-radius: 5px; box-shadow: 5px 5px 1px 0px rgba(50, 50, 50, 0.75); overflow: hidden;">
            <tbody>
              <tr style="background-color: #ced4e9;">
                <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #f44336; font-size: 12pt;">&#11044;</span></td>
                <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #ffee58; font-size: 12pt;">&#11044;</span></td>
                <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #66bb6a; font-size: 12pt;">&#11044;</span></td>
                <td style="width: 94%; text-align: center;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 14pt;"><strong>CODE</strong></span></td>
              </tr>
              <tr>
                <td colspan="4" style="width: 99%;">
                  <p style="margin: 0; padding: 0;">
                    <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">&nbsp;&nbsp;CRYPTO 1.0 REQUEST\r\n</span></strong><br />
                    <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">&nbsp;&nbsp;Name: &lt;Student Name&gt;\r\n</span></strong><br />
                    <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">&nbsp;&nbsp;PublicKey: &lt;Base16 string of your public key&gt;\r\n</span></strong>
                  </p>
                </td>
              </tr>
            </tbody>
          </table>
        </blockquote>
        <p></p>
      </li>
      <li><p style="margin: 0; padding: 0;"><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">After transmitting a packet to the server, your program must also receive a TCP reply from the server with the following payload:</span></p>
        <!-- CODE -->
        <blockquote>
          <table border="0" style="border-collapse: collapse; width: 85%; background-color: #000000; font-family: 'courier new', courier, monospace; border-style: none; border-radius: 5px; box-shadow: 5px 5px 1px 0px rgba(50, 50, 50, 0.75); overflow: hidden;">
            <tbody>
              <tr style="background-color: #ced4e9;">
                <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #f44336; font-size: 12pt;">&#11044;</span></td>
                <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #ffee58; font-size: 12pt;">&#11044;</span></td>
                <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #66bb6a; font-size: 12pt;">&#11044;</span></td>
                <td style="width: 94%; text-align: center;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 14pt;"><strong>CODE</strong></span></td>
              </tr>
              <tr>
                <td colspan="4" style="width: 99%;">
                  <p style="margin: 0; padding: 0;">
                    <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">&nbsp;&nbsp;CRYPTO 1.0 REQUEST\r\n</span></strong><br />
                    <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">&nbsp;&nbsp;Name: Dr. Matthew Kisow\r\n</span></strong><br />
                    <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">&nbsp;&nbsp;PublicKey: 245fb800e3ec462d84389b4e01074cb85e6f49e18df30002c2da69d9a853e507\r\n</span></strong><br />
                    <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">&nbsp;&nbsp;Ciphertext: &lt;Base16 string of ciphertext&gt;\r\n</span></strong>
                  </p>
                </td>
              </tr>
            </tbody>
          </table>
        </blockquote>
        <p></p>
      </li>
    </ol>
  </li>
</ol>

<ol style="font-family: arial, helvetica, sans-serif; font-size: 12pt;" start="2">
  <li><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Let's begin this part of our lab by starting in the /labs/LAB12/Part3 folder and starting the virtual environment.</span></li>
    <!-- CODE -->
    <table border="0" style="border-collapse: collapse; width: 85%; background-color: #000000; font-family: 'courier new', courier, monospace; border-style: none; border-radius: 5px; box-shadow: 5px 5px 1px 0px rgba(50, 50, 50, 0.75); overflow: hidden;">
      <tbody>
        <tr style="background-color: #ced4e9;">
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #f44336; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #ffee58; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #66bb6a; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 94%; text-align: center;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 14pt;"><strong>CODE</strong></span></td>
        </tr>
        <tr>
          <td colspan="4" style="width: 99%;">
            <p style="margin: 0; padding: 0;">
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #2dc26b;">&nbsp;&nbsp;# CHANGE DIRECTORY</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #ced4d9;">&nbsp;&nbsp;$ cd <span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">/labs/LAB12/Part3</span></span></strong><br /><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #2dc26b;">&nbsp;&nbsp;# ACTIVATE THE VIRTUAL ENVIRONMENT</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #ced4d9;">&nbsp;&nbsp;$ source <span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">venv/bin/activate</span></span></strong>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <p></p>
  </li>
  <li><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Use the nano text editor to start writing your part3.py decryption script.</span></p>
    <!-- CODE -->
    <table border="0" style="border-collapse: collapse; width: 85%; background-color: #000000; font-family: 'courier new', courier, monospace; border-style: none; border-radius: 5px; box-shadow: 5px 5px 1px 0px rgba(50, 50, 50, 0.75); overflow: hidden;">
      <tbody>
        <tr style="background-color: #ced4e9;">
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #f44336; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #ffee58; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #66bb6a; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 94%; text-align: center;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 14pt;"><strong>CODE</strong></span></td>
        </tr>
        <tr>
          <td colspan="4" style="width: 99%;">
            <p style="margin: 0; padding: 0;">
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #2dc26b;">&nbsp;&nbsp;# TEXT EDITOR</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #ced4d9;">&nbsp;&nbsp;$ nano <span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">part3.py</span></span></strong>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <p></p>
  </li>
  <li><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Test your script by invoking python3 part3.py.</span></p>
    <!-- CODE -->
    <table border="0" style="border-collapse: collapse; width: 85%; background-color: #000000; font-family: 'courier new', courier, monospace; border-style: none; border-radius: 5px; box-shadow: 5px 5px 1px 0px rgba(50, 50, 50, 0.75); overflow: hidden;">
      <tbody>
        <tr style="background-color: #ced4e9;">
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #f44336; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #ffee58; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #66bb6a; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 94%; text-align: center;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 14pt;"><strong>CODE</strong></span></td>
        </tr>
        <tr>
          <td colspan="4" style="width: 99%;">
            <p style="margin: 0; padding: 0;">
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #2dc26b;">&nbsp;&nbsp;# TESTING</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #ced4d9;">&nbsp;&nbsp;$ python3 <span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">part3.py</span></span></strong>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <p></p>
  </li>
  <li><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">When completed testing and you are ready to submit part3.py make sure you deactivate the virtual environment; then change back to the LAB12 directory.</span></p>
    <!-- CODE -->
    <table border="0" style="border-collapse: collapse; width: 85%; background-color: #000000; font-family: 'courier new', courier, monospace; border-style: none; border-radius: 5px; box-shadow: 5px 5px 1px 0px rgba(50, 50, 50, 0.75); overflow: hidden;">
      <tbody>
        <tr style="background-color: #ced4e9;">
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #f44336; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #ffee58; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #66bb6a; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 94%; text-align: center;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 14pt;"><strong>CODE</strong></span></td>
        </tr>
        <tr>
          <td colspan="4" style="width: 99%;">
            <p style="margin: 0; padding: 0;">
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #2dc26b;">&nbsp;&nbsp;# DEACTIVATE THE VIRTUAL ENVIRONMENT</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #ced4d9;">&nbsp;&nbsp;$ deactivate <span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;"></span></span></strong><br /><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #2dc26b;">&nbsp;&nbsp;# CHANGE BACK TO THE LAB12 DIRECTORY</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #ced4d9;">&nbsp;&nbsp;$ cd .. <span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;"></span></span></strong>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <p></p>

    <!-- TIP GREEN -->
    <table border="0" style="border-collapse: collapse; width: 75%; background-color: #bfedd2; border-style: none; border-radius: 5px; box-shadow: 5px 5px 1px 0px rgba(50, 50, 50, 0.75); overflow: hidden;">
      <tbody>
        <tr>
          <td style="width: 2%; background-color: #169179;">&nbsp;</td>
          <td colspan="2" style="width: 98%; text-align: left; vertical-align: top;">
            <p style="margin: 0; padding: 0;"><img src="https://web.acd.ccac.edu/~mkisow/assets/green-tip-16x22.svg"  width="16" height="22" style="border: 0px solid #000000;" alt="tip"/><strong><span style="font-family: arial, helvetica, sans-serif; color: #169179; font-size: 14pt;">TIP</span></strong></p>
          </td>
        </tr>
        <tr>
          <td style="width: 2%; background-color: #169179;">&nbsp;</td>
          <td style="width: 5%; text-align: right; vertical-align: top;"><strong><span style="font-family: arial, helvetica, sans-serif; color: #169179; font-size: 12pt;">&#x25CF;</span></strong></td>
          <td style="width: 93%;">
            <p style="margin: 0; padding: 0;"><span style="font-family: arial, helvetica, sans-serif; color: #169179; font-size: 12pt;">Does the server "respond" with a message of length 0? That means that you sent an invalid request. Upon receiving an invalid request, the server closes the socket immediately, which you will notice as <span style="font-family: 'courier new', courier, monospace; background-color: #ecdbdb; color: #ba372a;"><strong>recv() </strong></span>returning with a byte array of length 0.</span></p>
          </td>
        </tr>
      </tbody>
    </table>
    <p></p>

    <!-- CODE -->
    <table border="0" style="border-collapse: collapse; width: 85%; background-color: #000000; font-family: 'courier new', courier, monospace; border-style: none; border-radius: 5px; box-shadow: 5px 5px 1px 0px rgba(50, 50, 50, 0.75); overflow: hidden;">
      <tbody>
        <tr style="background-color: #ced4e9;">
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #f44336; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #ffee58; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #66bb6a; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 94%; text-align: center;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 14pt;"><strong>EXAMPLE REQUEST AND REPLY</strong></span></td>
        </tr>
        <tr>
          <td colspan="4" style="width: 99%;">
            <p style="margin: 0; padding: 0;">
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">&nbsp;&nbsp;CRYPTO 1.0 REQUEST</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">&nbsp;&nbsp;Name: Any Student</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">&nbsp;&nbsp;PublicKey: 245fb800e3ec462d84389b4e01074cb85e6f49e18df30002c2da69d9a853e507</span></strong><br />
              <br/>
              <br/>
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">&nbsp;&nbsp;CRYPTO 1.0 REQUEST</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">&nbsp;&nbsp;Name: Dr. Matthew Kisow</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">&nbsp;&nbsp;PublicKey: 245fb800e3ec462d84389b4e01074cb85e6f49e18df30002c2da69d9a853e507</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">&nbsp;&nbsp;Ciphertext: B0B84DC3557E2595D2D8B5B30565281A93EA140CCF739EA3504B2147A1EBDA63</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A2FF14E4E61A5F0384342E7E118D644B85152E6A1F95AD42165A62D46E204D23</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;27CAEE995BF2A9DEE291868B20971E26F02FF472CBE36F5D</span></strong><br />
            </p>
          </td>
        </tr>
      </tbody>
    </table>
  <p></p>
  </li>
</ol>

<!-- 3.5 DELIVERABLE -->
<blockquote>
  <table border="0" style="border-collapse: collapse; width: 85%; background-color: #ced4d9; border-style: none; border-radius: 5px; box-shadow: 5px 5px 1px 0px rgba(50, 50, 50, 0.75); overflow: hidden;">
    <tbody>
      <tr>
        <td style="width: 2%; background-color: #000000;">&nbsp;</td>
        <td colspan="5" style="width: 98%; text-align: left; vertical-align: top;">
          <p style="margin: 0; padding: 0;">
            <img src="https://web.acd.ccac.edu/~mkisow/assets/black-deliverable-24x24.svg"  style="border: 0px solid #000000;" height="24" width="24" alt="deliverable"/>
            <strong><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 14pt;">DELIVERABLE</span></strong>
          </p>
        </td>
      </tr>
      <tr>
        <td style="width: 2%; background-color: #000000;">&nbsp;</td>
        <td style="width: 5%; text-align: right; vertical-align: top;"><strong><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">3.5</span></strong></td>
        <td style="width: 93%;">
          <p style="margin: 0; padding: 0;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">Write a Python3 program named <span style="font-family: 'courier new', courier, monospace; background-color: #ecdbdb; color: #ba372a;"><strong>part3.py</strong></span> that communicates with the server, receives the ciphertext, and prints the plaintext message to the screen.</span></p>
        </td>
      </tr>
    </tbody>
  </table>
</blockquote>


<!-- PART 4 -->
<hr />
<span style="font-family: arial, helvetica, sans-serif; font-size: 14pt; color: #ba372a;"><strong>Part 4 - Password Storage</strong></span></p>

<ol style="font-family: arial, helvetica, sans-serif; font-size: 12pt;" start="1">
  <li><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><p>Dr. Kisow is tired of dealing with keys, and would rather deal with human friendly passwords. He has encrypted his secret data via the following process:</span></p>
    <ol style="list-style-type: lower-alpha;" start="a">

      <!-- A -->
      <li><p style="margin: 0; padding: 0;"><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Use scrypt password-hashing mechanism to produce 32-byte key from password. CPU and memory difficulty levels (iterations) were changed from the default values to <span style="font-family: 'courier new', courier, monospace; background-color: #ecdbdb; color: #ba372a;"><strong>SCRYPT_OPSLIMIT_INTERACTIVE</strong></span> and <span style="font-family: 'courier new', courier, monospace; background-color: #ecdbdb; color: #ba372a;"><strong>SCRYPT_MEMLIMIT_INTERACTIVE</strong></span> to provide a balance between difficulty and time.</span></p></li>
      <li><p style="margin: 0; padding: 0;"><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Generate a random key and protect it via symmetric key encryption (Salsa20/Poly1305 MAC) with the password-derived key. This is the "outer box".</span></p></li>
      <li><p style="margin: 0; padding: 0;"><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Take the secret payload and protect it via symmetric key encryption with the random key. This is the "inner box". This allows the password to be changed in the future without needing to re-encrypt the entire secret payload.</span></p></li>
    </ol>
  </li>
</ol>

<ol style="font-family: arial, helvetica, sans-serif; font-size: 12pt;" start="2">
  <li><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;"><p>One file is provided: <span style="font-family: 'courier new', courier, monospace; background-color: #ecdbdb; color: #ba372a;"><strong>part4.ciphertext.bin.</strong></span> This encrypted file has been saved to disk in the following format:</span></p>
    <ol style="list-style-type: lower-alpha;" start="a">

      <!-- A -->
      <li><p style="margin: 0; padding: 0;"><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Password salt: 32 bytes</span></p></li>
      <li><p style="margin: 0; padding: 0;"><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Outer box, encrypted: 72 bytes (32 byte key + 24 byte nonce + 16 byte auth). The outer box contains the random key.</span></p></li>
      <li><p style="margin: 0; padding: 0;"><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Inner box, encrypted: Variable length (variable-length payload + 24 byte nonce + 16 byte auth). The inner box contains the secret payload.</span></p></li>
    </ol>
  </li>
</ol>

<!-- NOTE BLUE -->
<blockquote>
  <table border="0" style="border-collapse: collapse; width: 75%; background-color: #c2e0f4; border-style: none; border-radius: 5px; box-shadow: 5px 5px 1px 0px rgba(50, 50, 50, 0.75); overflow: hidden;">
    <tbody>
      <tr>
        <td style="width: 2%; background-color: #236fa1;">&nbsp;</td>
        <td colspan="2" style="width: 98%; text-align: left; vertical-align: top;">
          <p style="margin: 0; padding: 0;"><img src="https://web.acd.ccac.edu/~mkisow/assets/blue-note-22x22.svg"  width="22" height="22" style="border: 0px solid #000000;" alt="note"/><strong><span style="font-family: arial, helvetica, sans-serif; color: #236fa1; font-size: 14pt;">NOTE</span></strong></p>
        </td>
      </tr>
      <tr>
        <td style="width: 2%; background-color: #236fa1;">&nbsp;</td>
        <td style="width: 5%; text-align: right; vertical-align: top;"><strong><span style="font-family: arial, helvetica, sans-serif; color: #236fa1; font-size: 12pt;">&#x25CF;</span></strong></td>
        <td style="width: 93%;">
          <p style="margin: 0; padding: 0;"><span style="font-family: arial, helvetica, sans-serif; color: #236fa1; font-size: 12pt;">This secret payload is <em>NOT</em> ASCII text. Rather, it is mystery data and you should discover what it is using any available tools at your disposal.</span></p>
        </td>
      </tr>
    </tbody>
  </table>
</blockquote>
<p></p>

<!-- NOTE BLUE -->
<blockquote>
  <table border="0" style="border-collapse: collapse; width: 75%; background-color: #c2e0f4; border-style: none; border-radius: 5px; box-shadow: 5px 5px 1px 0px rgba(50, 50, 50, 0.75); overflow: hidden;">
    <tbody>
      <tr>
        <td style="width: 2%; background-color: #236fa1;">&nbsp;</td>
        <td colspan="2" style="width: 98%; text-align: left; vertical-align: top;">
          <p style="margin: 0; padding: 0;"><img src="https://web.acd.ccac.edu/~mkisow/assets/blue-note-22x22.svg"  width="22" height="22" style="border: 0px solid #000000;" alt="note"/><strong><span style="font-family: arial, helvetica, sans-serif; color: #236fa1; font-size: 14pt;">NOTE</span></strong></p>
        </td>
      </tr>
      <tr>
        <td style="width: 2%; background-color: #236fa1;">&nbsp;</td>
        <td style="width: 5%; text-align: right; vertical-align: top;"><strong><span style="font-family: arial, helvetica, sans-serif; color: #236fa1; font-size: 12pt;">&#x25CF;</span></strong></td>
        <td style="width: 93%;">
          <p style="margin: 0; padding: 0;"><span style="font-family: arial, helvetica, sans-serif; color: #236fa1; font-size: 12pt;">You'll need the <a href="https://www.youtube.com/watch?v=ySqec8WrEQQ" target="_blank" rel="noopener"><span style="color: #ba372a;">super secret</span></a> password to get started. (Enter it in lowercase)</span></p>
        </td>
      </tr>
    </tbody>
  </table>
</blockquote>
<p></p>
<ol style="font-family: arial, helvetica, sans-serif; font-size: 12pt;" start="3">
  <li><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Let's begin this part of our lab by starting in the /labs/LAB12/Part4 folder and starting the virtual environment.</span></li>
    <!-- CODE -->
    <table border="0" style="border-collapse: collapse; width: 85%; background-color: #000000; font-family: 'courier new', courier, monospace; border-style: none; border-radius: 5px; box-shadow: 5px 5px 1px 0px rgba(50, 50, 50, 0.75); overflow: hidden;">
      <tbody>
        <tr style="background-color: #ced4e9;">
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #f44336; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #ffee58; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #66bb6a; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 94%; text-align: center;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 14pt;"><strong>CODE</strong></span></td>
        </tr>
        <tr>
          <td colspan="4" style="width: 99%;">
            <p style="margin: 0; padding: 0;">
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #2dc26b;">&nbsp;&nbsp;# CHANGE DIRECTORY</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #ced4d9;">&nbsp;&nbsp;$ cd <span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">/labs/LAB12/Part4</span></span></strong><br /><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #2dc26b;">&nbsp;&nbsp;# ACTIVATE THE VIRTUAL ENVIRONMENT</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #ced4d9;">&nbsp;&nbsp;$ source <span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">venv/bin/activate</span></span></strong>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <p></p>
  </li>
  <li><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Use the nano text editor to start writing your part4.py decryption script.</span></p>
    <!-- CODE -->
    <table border="0" style="border-collapse: collapse; width: 85%; background-color: #000000; font-family: 'courier new', courier, monospace; border-style: none; border-radius: 5px; box-shadow: 5px 5px 1px 0px rgba(50, 50, 50, 0.75); overflow: hidden;">
      <tbody>
        <tr style="background-color: #ced4e9;">
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #f44336; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #ffee58; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #66bb6a; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 94%; text-align: center;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 14pt;"><strong>CODE</strong></span></td>
        </tr>
        <tr>
          <td colspan="4" style="width: 99%;">
            <p style="margin: 0; padding: 0;">
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #2dc26b;">&nbsp;&nbsp;# TEXT EDITOR</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #ced4d9;">&nbsp;&nbsp;$ nano <span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">part4.py</span></span></strong>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <p></p>
  </li>
  <li><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">Test your script by invoking python3 part4.py.</span></p>
    <!-- CODE -->
    <table border="0" style="border-collapse: collapse; width: 85%; background-color: #000000; font-family: 'courier new', courier, monospace; border-style: none; border-radius: 5px; box-shadow: 5px 5px 1px 0px rgba(50, 50, 50, 0.75); overflow: hidden;">
      <tbody>
        <tr style="background-color: #ced4e9;">
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #f44336; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #ffee58; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #66bb6a; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 94%; text-align: center;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 14pt;"><strong>CODE</strong></span></td>
        </tr>
        <tr>
          <td colspan="4" style="width: 99%;">
            <p style="margin: 0; padding: 0;">
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #2dc26b;">&nbsp;&nbsp;# TESTING</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #ced4d9;">&nbsp;&nbsp;$ python3 <span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;">part4.py part4.ciphertext.bin</span></span></strong>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <p></p>
  </li>
  <li><p><span style="font-family: arial, helvetica, sans-serif; font-size: 12pt;">When completed testing and you are ready to submit part4.py make sure you deactivate the virtual environment; then change back to the LAB12 directory.</span></p>
    <!-- CODE -->
    <table border="0" style="border-collapse: collapse; width: 85%; background-color: #000000; font-family: 'courier new', courier, monospace; border-style: none; border-radius: 5px; box-shadow: 5px 5px 1px 0px rgba(50, 50, 50, 0.75); overflow: hidden;">
      <tbody>
        <tr style="background-color: #ced4e9;">
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #f44336; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #ffee58; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 2%; text-align: center; vertical-align: middle;"><span style="font-family: arial, helvetica, sans-serif; color: #66bb6a; font-size: 12pt;">&#11044;</span></td>
          <td style="width: 94%; text-align: center;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 14pt;"><strong>CODE</strong></span></td>
        </tr>
        <tr>
          <td colspan="4" style="width: 99%;">
            <p style="margin: 0; padding: 0;">
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #2dc26b;">&nbsp;&nbsp;# DEACTIVATE THE VIRTUAL ENVIRONMENT</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #ced4d9;">&nbsp;&nbsp;$ deactivate <span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;"></span></span></strong><br /><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #2dc26b;">&nbsp;&nbsp;# CHANGE BACK TO THE LAB12 DIRECTORY</span></strong><br />
              <strong><span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #ced4d9;">&nbsp;&nbsp;$ cd .. <span style="font-family: 'courier new', courier, monospace; font-size: 12pt; color: #236fa1;"></span></span></strong>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <p></p>
  </li>
</ol>

<!-- 4.6 DELIVERABLE -->
<blockquote>
  <table border="0" style="border-collapse: collapse; width: 85%; background-color: #ced4d9; border-style: none; border-radius: 5px; box-shadow: 5px 5px 1px 0px rgba(50, 50, 50, 0.75); overflow: hidden;">
    <tbody>
      <tr>
        <td style="width: 2%; background-color: #000000;">&nbsp;</td>
        <td colspan="5" style="width: 98%; text-align: left; vertical-align: top;">
          <p style="margin: 0; padding: 0;">
            <img src="https://web.acd.ccac.edu/~mkisow/assets/black-deliverable-24x24.svg"  style="border: 0px solid #000000;" height="24" width="24" alt="deliverable"/>
            <strong><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 14pt;">DELIVERABLE</span></strong>
          </p>
        </td>
      </tr>
      <tr>
        <td style="width: 2%; background-color: #000000;">&nbsp;</td>
        <td style="width: 5%; text-align: right; vertical-align: top;"><strong><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">4.6</span></strong></td>
        <td colspan="3" style="width: 93%;"></td>
      </tr>
      <tr>
        <td style="width: 2%; background-color: #000000;">&nbsp;</td>
        <td colspan="2" style="width: 7%; text-align: right; vertical-align: top;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;"><strong>A.</strong></span></td>
        <td colspan="2" style="width: 91%;">
          <p style="margin: 0; padding: 0;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">Write a Python3 program named <span style="font-family: 'courier new', courier, monospace; background-color: #ecdbdb; color: #ba372a;"><strong>part4.py</strong></span> that decrypts the secret payload and saves the resulting file to disk. Your program should print the following output on screen:</span></p>
        </td>
      </tr>
      <tr>
        <td style="width: 2%; background-color: #000000;">&nbsp;</td>
        <td colspan="3" style="width: 9%; text-align: right; vertical-align: top;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;"><strong>i.</strong></span></td>
        <td style="width: 89%;">
          <p style="margin: 0; padding: 0;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">The filename of the decrypted secret payload that was written to disk.</span></p>
        </td>
      </tr>
      <tr>
        <td style="width: 2%; background-color: #000000;">&nbsp;</td>
        <td colspan="3" style="width: 9%; text-align: right; vertical-align: top;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;"><strong>ii.</strong></span></td>
        <td style="width: 89%;">
          <p style="margin: 0; padding: 0;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">A human description of what kind of file was produced (in your own words).</span></p>
        </td>
      </tr>
      <tr>
        <td style="width: 2%; background-color: #000000;">&nbsp;</td>
        <td colspan="3" style="width: 9%; text-align: right; vertical-align: top;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;"><strong>iii.</strong></span></td>
        <td style="width: 89%;">
          <p style="margin: 0; padding: 0;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">A human description of what kind of viewer could be used to display the file. Name one specific viewer program that would work.</span></p>
        </td>
      </tr>
      <tr>
        <td style="width: 2%; background-color: #000000;">&nbsp;</td>
        <td colspan="3" style="width: 9%; text-align: right; vertical-align: top;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;"><strong>iv.</strong></span></td>
        <td style="width: 89%;">
          <p style="margin: 0; padding: 0;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">The SHA-256 hash of the secret payload file. Use the Libsodium library or the Python hashlib library to compute this hash, not a standalone command line utility.</span></p>
        </td>
      </tr>
      <tr>
        <td style="width: 2%; background-color: #000000;">&nbsp;</td>
        <td colspan="2" style="width: 7%; text-align: right; vertical-align: top;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;"><strong>B.</strong></span></td>
        <td colspan="2" style="width: 91%;">
          <p style="margin: 0; padding: 0;"><span style="font-family: arial, helvetica, sans-serif; color: #000000; font-size: 12pt;">Write a Python 3 program named <span style="font-family: 'courier new', courier, monospace; background-color: #ecdbdb; color: #ba372a;"><strong>part4_pw_change.py</strong></span> that allows the user to change the password without needing to re-encrypt the entire payload. Use the new password <strong>"ethical-hacking"</strong>. The new output file should be named <span style="font-family: 'courier new', courier, monospace; background-color: #ecdbdb; color: #ba372a;"><strong>part4.ciphertext-new.bin.</strong></span></span></p>
        </td>
      </tr>
    </tbody>
  </table>
</blockquote>
<p></p>

<!-- TIP GREEN -->
<blockquote>
  <table border="0" style="border-collapse: collapse; width: 75%; background-color: #bfedd2; border-style: none; border-radius: 5px; box-shadow: 5px 5px 1px 0px rgba(50, 50, 50, 0.75); overflow: hidden;">
    <tbody>
      <tr>
        <td style="width: 2%; background-color: #169179;">&nbsp;</td>
        <td colspan="2" style="width: 98%; text-align: left; vertical-align: top;">
          <p style="margin: 0; padding: 0;"><img src="https://web.acd.ccac.edu/~mkisow/assets/green-tip-16x22.svg"  width="16" height="22" style="border: 0px solid #000000;" alt="tip"/><strong><span style="font-family: arial, helvetica, sans-serif; color: #169179; font-size: 14pt;">TIP</span></strong></p>
        </td>
      </tr>
      <tr>
        <td style="width: 2%; background-color: #169179;">&nbsp;</td>
        <td style="width: 5%; text-align: right; vertical-align: top;"><strong><span style="font-family: arial, helvetica, sans-serif; color: #169179; font-size: 12pt;">&#x25CF;</span></strong></td>
        <td style="width: 93%;">
          <p style="margin: 0; padding: 0;"><span style="font-family: arial, helvetica, sans-serif; color: #169179; font-size: 12pt;">Unsure if your <span style="font-family: 'courier new', courier, monospace; background-color: #ecdbdb; color: #ba372a;"><strong>part4_pw_change.py</strong></span> script is working correctly? You can test it by temporarily making the following changes to your <span style="font-family: 'courier new', courier, monospace; background-color: #ecdbdb; color: #ba372a;"><strong>part4.py</strong></span> script:<br/><br/>(1) Change the input filename to <span style="font-family: 'courier new', courier, monospace; background-color: #ecdbdb; color: #ba372a;"><strong>part4.ciphertext-new.bin</strong></span>, and<br/>(2) Change the password to "ethical-hacking". If you get the same secret payload as before, then you know your password change script works! Be sure to restore the original functionality of <span style="font-family: 'courier new', courier, monospace; background-color: #ecdbdb; color: #ba372a;"><strong>part4.py </strong></span>before turning it in.</span></p>
        </td>
      </tr>
    </tbody>
  </table>
</blockquote>
<p></p>

<!-- COPYRIGHT -->
<hr />
<p style="font-family: arial, helvetica, sans-serif; font-size: 12pt; text-align: center; color: #000000;">Copyright &copy; 2022-2025 Dr. Matthew Kisow. All Rights Reserved</p>